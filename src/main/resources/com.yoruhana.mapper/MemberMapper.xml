<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.yoruhana.mapper.MemberMapper">

    <!--회원가입-->
    <insert id="insertJoin" parameterType="com.yoruhana.entity.MemberVO">
        insert into members (mb_country,mb_nick,mb_name, mb_id, mb_pw,mb_tel,mb_bir, mb_stat,mb_join_date, mb_prof_stat,mb_agree1,mb_agree2,mb_see ,mb_file, mb_sex)
                    values(#{mb_country}, #{mb_nick} ,#{mb_name},#{mb_id},#{mb_pw},CONCAT(#{mb_tel1},'-',#{mb_tel2},'-',#{mb_tel3}),CONCAT(#{mb_bir1},#{mb_bir2},#{mb_bir3}),0,NOW(),1,0,0,0,"/img/person-circle.svg",#{mb_sex})
    </insert>

    <select id = "login" parameterType="com.yoruhana.entity.MemberVO" resultType="com.yoruhana.entity.MemberVO">
        select * from members where mb_id = #{mb_id} and mb_pw = #{mb_pw}
    </select>

    <select id="checkNick" parameterType="String" resultType="com.yoruhana.entity.MemberVO">
        select * from members where mb_nick = #{mb_nick}
    </select>

    <select id="checkId" parameterType="String" resultType="com.yoruhana.entity.MemberVO">
        select * from members where mb_id = #{mb_id}
    </select>

    <select id="getInfo" parameterType="int" resultType="com.yoruhana.entity.MemberVO">
        select * from members where mb_no = #{mb_no}
    </select>

    <select id="getProfPic" parameterType="int" resultType="com.yoruhana.entity.MemberVO">
        select * from membersPic where mb_no = #{mb_no}
    </select>

    <update id = "mypageUpdate" parameterType="com.yoruhana.entity.MemberVO">
        update members set mb_pw = #{mb_pw} , mb_tel = CONCAT(#{mb_tel1},'-',#{mb_tel2},'-',#{mb_tel3}) where mb_no = #{mb_no}
    </update>

    <update id ="updateProfile" parameterType="com.yoruhana.entity.MemberVO">
        update members set mb_file = #{mb_file}, mb_prof_stat = #{mb_prof_stat}, mb_prof_content = #{mb_prof_content} where mb_no = #{mb_no}
    </update>

    <select id="searchPenpalList" resultType="com.yoruhana.entity.MemberVO">
        SELECT * FROM members WHERE mb_prof_stat = 0 and mb_stat =0
    </select>
</mapper>